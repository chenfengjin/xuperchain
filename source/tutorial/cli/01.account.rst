使用命令行管理账号
==================


设置合约方法的ACL
------------------

1. 准备desc文件setMethodACL.desc

    .. code-block:: json
        
        {
            "module_name": "xkernel",
            "method_name": "SetMethodAcl",
            "args" : {
                "contract_name": "counter",
                "method_name": "increase",
                "acl": "{\"pm\": {\"rule\": 1,\"acceptValue\": 1.0},\"aksWeight\": {\"UU4kyZcQinAMsBSPRLUA34ebXrfZtB4Z8\": 1}}"
                }
        }

    参数说明：

    - **module_name**： 模块名称，用固定值xkernel 
    - **method_name** ：方法名称，用固定值SetMethodAcl
    - **contract_name**：合约名称
    - **method_name**：合约方法名称
    - **acl**：合约方法的acl

2. 设置合约方法ACL

    设置合约方法ACL的操作，需符合合约账号的ACL，在3.2节，使用 **XC1111111111111111@xuper** 部署的counter合约，合约账号ACL里 只有1个AK，所以在data/acl/addrs中添加1行，如果合约账号ACL里有多个AK，则填写多行。

    .. code-block:: bash

        echo "XC1111111111111111@xuper/dpzuVdosQrF2kmzumhVeFQZa1aYcdgFpN" > data/acl/addrs

    执行如下命令，设置ACL：

    .. code-block:: bash

        xchain-cli multisig gen --desc ./setMethodACL.desc --fee 1 -H 127.0.0.1:37101
        xchain-cli multisig sign --output sign.out
        xchain-cli multisig send sign.out sign.out -H 127.0.0.1:37101

3. 查看合约方法ACL

    .. code-block:: bash

            [work@]$ deploy-env -> xchain-cli acl query --contract counter --method increase -H :37101    
            # 执行结果  
            # { 
            #   "pm": { 
            #     "rule": 1,    
            #     "acceptValue": 1
            #   },  
            #   "aksWeight": {  
            #     "UU4kyZcQinAMsBSPRLUA34ebXrfZtB4Z8": 1    
            #   }   
            # }
